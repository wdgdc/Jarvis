/**
 * jarvis -  Jarvis is your admin assistant, putting WordPress at your fingertips via a quicksearch interface.
 * @version v0.50.0
 * @link https://github.com/WDGDC/Jarvis#readme
 * @license MIT
 */
!function(e,i,t,n,a){var o={createElement:function(e,i,t){var n=document.createElement(e);if(i)for(var a in i)i.hasOwnProperty(a)&&n.setAttribute(a,i[a]);return t&&(n.innerHTML=t),n},inputInFocus:function(e){return/INPUT|SELECT|TEXTAREA/.test(e.target.tagName)||"true"===e.target.contentEditable},isJarvisXhr:function(e,i,t){return/action=jarvis-search/.test(t.url)},getComputedStyle:function(i){return e.getComputedStyle?e.getComputedStyle(i,!1):i.currentStyle},trim:function(e){return String.prototype.trim?e.trim():e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}},s=function(e){var t=this;this.settings={keyCode:191,separator:"Â»",loadingimg:"/wp-content/plugins/wp-jarvis/img/wpspin.gif"},i.extend(this.settings,e),this.settings.keyCode=parseInt(this.settings.keyCode,10),this.opened=!1,this.localData=[],this.modal=o.createElement("div",{id:"jarvis-modal"}),this.search=o.createElement("input",{type:"text",id:"jarvis-search"}),this.overlay=o.createElement("div",{id:"jarvis-overlay"}),this.overlay.addEventListener("click",function(){t.close()},!0),this.term="",this.loading=o.createElement("img",{src:this.settings.loadingimg,id:"jarvis-loading"}),this.templates={},this.templates.suggestion=a.compile(['<span class="{{prefix}} {{kind}}">','<a href="{{href}}">','<span class="jarvis-icon {{iconclass}}" style="{{image}}" title="{{prefix}}"></span>','<span class="jarvis-title" title="{{{title}}}">{{{title}}}</span>',"</a>","</span>"].join("\n")),this.icons={},this.iconMap={attachment:{"image-icon":"media",dashicon:"dashicons-admin-media"},category:{"image-icon":"posts",dashicon:"dashicons-category"},nav_menu:{"image-icon":"appearance",dashicon:"dashicons-admin-appearance"},nav_menu_item:{"image-icon":"appearance",dashicon:"dashicons-admin-appearance"},page:{"image-icon":"pages",dashicon:"dashicons-admin-page"},post:{"image-icon":"posts",dashicon:"dashicons-admin-post"},post_tag:{"image-icon":"posts",dashicon:"dashicons-tag"},post_format:{"image-icon":"posts",dashicon:"dashicons-format-standard"},term:{"image-icon":"posts",dashicon:"dashicons-category"}},/complete|loaded/.test(document.readyState)?this.init():document.addEventListener("DOMContentLoaded",function(e){t.init.call(t,e)})};s.prototype={close:function(e){this.opened=!1,this.overlay.parentNode.removeChild(this.overlay),this.modal.parentNode.removeChild(this.modal),i(this.search).typeahead("destroy")},init:function(){var t,n=this;i("#wp-admin-bar-jarvis_menubar_icon a").on("click",function(e){n.open(e)}),i("#adminmenu a").each(function(e,a){var s,c,r,d,p,h;switch(p=function(e){return i(e).clone().find("span").remove().end().text()},c=i(this).closest(".menu-top"),s=p(c.find("a > .wp-menu-name")),r=p(this),h=function(){var e,t,n=c.find(".wp-menu-image")[0],a=c.find(".wp-menu-image img")[0];return n&&n.className.indexOf("dashicons-before")>-1?(t=n.className.split(" "),t.splice(i.inArray("wp-menu-image",t),1),t.splice(i.inArray("dashicons-before",t),1),{type:"dashicon",icon:t[0]}):a?{type:"image",icon:"background-image:url("+a.src+");background-position:center"}:n?(e=o.getComputedStyle(n),"string"==typeof e.backgroundPosition?{type:"image",icon:"background-image:"+e.backgroundImage+";background-position:"+e.backgroundPosition}:{type:"image",icon:"background-image:"+e.backgroundImage+";background-position-x:"+e.backgroundPositionX+";background-position-y:"+e.backgroundPositionY}):null}(),n.icons[s.toLowerCase()]=h,!0){case""===s:case s===r:d=r;break;default:d=s+" "+n.settings.separator+" "+r}if(t={id:this.id||null,kind:"href",href:this.href,prefix:o.trim(s).toLowerCase(),title:o.trim(d),type:"menu"},h)switch(t.icontype=h.type,h.type){case"dashicon":t.iconclass="dashicons-before "+h.icon,t.image="";break;case"image":t.iconclass="image-icon",t.image=h.icon}n.localData.push(t)});for(var a in n.iconMap)n.iconMap.hasOwnProperty(a)&&(n.icons[a]=n.settings.dashicons?n.iconMap[a]:n.icons[n.iconMap[a]["image-icon"]]);document.addEventListener&&document.addEventListener("keydown",function(e){e.keyCode!==n.settings.keyCode||o.inputInFocus(e)||(e.preventDefault(),e.stopPropagation())},!0),i(document).on("keyup",function(e){n.keystroke(e)}),i(e).on("resize",function(){n.opened&&n.resize.apply(n,arguments)}),i(document).ajaxSend(function(e,i,t){n.opened&&o.isJarvisXhr.apply(this,arguments)&&n.modal.appendChild(n.loading)}),i(document).ajaxComplete(function(e,i,t){n.opened&&o.isJarvisXhr.apply(this,arguments)&&n.loading.parentNode.removeChild(n.loading)})},keystroke:function(e){switch(e.preventDefault(),e.stopPropagation(),!0){case this.opened&&27===e.keyCode:this.close();break;case o.inputInFocus(e):return;case!this.opened&&e.keyCode===this.settings.keyCode:this.open()}},go:function(e,i,t){location.href=i.href},open:function(t){var a=this;t&&t.preventDefault&&t.preventDefault(),this.opened=!0,this.modal.appendChild(this.search),document.body.appendChild(this.overlay),document.body.appendChild(this.modal),this.modal.style.marginLeft=Math.ceil(-1*this.modal.offsetWidth/2)+"px",i(this.search).typeahead({hint:!0,highlight:!0,minLength:1},{name:"results",limit:10,display:"title",source:new n({local:this.localData,datumTokenizer:n.tokenizers.obj.whitespace("title"),queryTokenizer:n.tokenizers.whitespace,remote:{url:e.ajaxurl+"?action=jarvis-search&q=%s",wildcard:"%s",transform:function(e){return e.data.map(function(e){return e.icon=void 0!==a.icons[e.type]?a.icons[e.type]:a.icons.post,e.iconclass=a.settings.dashicons?"dashicons-before "+e.icon.dashicon:"image-icon",e.image=e.icon.icon,e})}}}),templates:{suggestion:function(e){return a.templates.suggestion.render(e)}}}).on("typeahead:selected",function(){a.go.apply(a,arguments)}).on("keyup",function(){a.term=this.value}).typeahead("val",this.term).focus()},resize:function(){this.modal.style.marginLeft=Math.max(-1*this.modal.offsetWidth/2)+"px"}},e.jarvis=new s(t)}(this,window.jQuery,window.jarvisOptions,window.Bloodhound,window.Hogan);